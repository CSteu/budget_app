import{_ as S,r as i,o as V,l as f,c as r,b as o,w as v,n as _,F as g,p as w,v as D,q as U,g as I,x as p,a as l,t as d,k as M}from"./index-Dz63qjqx.js";const N={class:"form-container"},C={class:"form-group"},E=["value"],P={class:"form-group"},R=["value"],$={class:"form-group"},q=["max"],L={key:0,class:"error-message"},j=["disabled"],z={__name:"TransferForm",setup(G){const u=i([]),n=i(null),c=i(null),s=i(0),b=M();V(async()=>{try{const a=await p.get("https://localhost:5001/api/Accounts");u.value=a.data}catch(a){console.error("Failed to fetch accounts:",a)}});const F=f(()=>u.value.filter(a=>a.id!==n.value)),m=f(()=>{const a=u.value.find(e=>e.id===n.value);return a?a.currentBalance:0}),h=f(()=>n.value&&c.value&&s.value>0&&s.value<=m.value),B=async()=>{if(h.value)try{const a={amount:s.value,sendingAccountId:n.value,recievingAccountId:c.value,date:new Date};await p.post("https://localhost:5001/api/Transfers",a),await A(n.value,-s.value),await A(c.value,s.value),b.push("/accounts")}catch(a){console.error("Failed to complete the transfer:",a),alert("Failed to complete the transfer. Please try again.")}else alert("Please fill out all fields correctly.")},A=async(a,e)=>{try{const t=u.value.find(k=>k.id===a);if(!t)throw new Error("Account not found");const x=t.currentBalance+e;await p.put(`https://localhost:5001/api/Accounts/${a}`,{Name:"test",currentBalance:x})}catch(t){console.error(`Failed to update balance for account ${a}:`,t)}},T=()=>{b.push("/accounts")},y=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a);return(a,e)=>(l(),r("div",N,[o("div",{class:"form-header"},[o("button",{class:"back-button",onClick:T},"Return"),e[3]||(e[3]=o("h1",{class:"form-title"},"Transfer Funds",-1))]),e[7]||(e[7]=o("p",{class:"form-description"}," Transfer funds from one account to another. Please ensure you have sufficient funds in the source account. ",-1)),o("form",{onSubmit:I(B,["prevent"]),class:"form-content"},[o("div",C,[e[4]||(e[4]=o("label",{for:"fromAccount",class:"form-label"},"From Account",-1)),v(o("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),id:"fromAccount",class:"form-input"},[(l(!0),r(g,null,w(u.value,t=>(l(),r("option",{key:t.id,value:t.id},d(t.name)+" ("+d(y(t.currentBalance))+") ",9,E))),128))],512),[[_,n.value]])]),o("div",P,[e[5]||(e[5]=o("label",{for:"toAccount",class:"form-label"},"To Account",-1)),v(o("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),id:"toAccount",class:"form-input"},[(l(!0),r(g,null,w(F.value,t=>(l(),r("option",{key:t.id,value:t.id},d(t.name)+" ("+d(y(t.currentBalance))+") ",9,R))),128))],512),[[_,c.value]])]),o("div",$,[e[6]||(e[6]=o("label",{for:"amount",class:"form-label"},"Transfer Amount",-1)),v(o("input",{type:"number",id:"amount","onUpdate:modelValue":e[2]||(e[2]=t=>s.value=t),class:"form-input",min:"0",max:m.value,placeholder:"Enter amount to transfer"},null,8,q),[[D,s.value,void 0,{number:!0}]]),s.value>m.value?(l(),r("span",L," Transfer amount exceeds available balance. ")):U("",!0)]),o("button",{type:"submit",class:"submit-button",disabled:!h.value}," Transfer ",8,j)],32)]))}},K=S(z,[["__scopeId","data-v-b5d0ea6e"]]);export{K as default};
